# è´¦å•å¤ç›˜åŠŸèƒ½å‰ç«¯é›†æˆ - ä»£ç åº“æ¢ç´¢æŠ¥å‘Š

**é¡¹ç›®**: Notion Bill Importer
**åŠŸèƒ½**: è´¦å•å¤ç›˜åŠŸèƒ½å‰ç«¯é›†æˆ
**æ—¥æœŸ**: 2026-02-03
**é˜¶æ®µ**: Exploration - ä»£ç åº“æ¢ç´¢

---

## ä¸€ã€ä»£ç åº“ç»“æ„

### é¡¹ç›®ç›®å½•ç»“æ„
```
Import_Bill_To_Notion/
â”œâ”€â”€ web_service/
â”‚   â”œâ”€â”€ main.py                 # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.py             # è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ users.py            # ç”¨æˆ·è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ bills.py            # è´¦å•è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ admin.py            # ç®¡ç†å‘˜è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ upload.py           # ä¸Šä¼ è·¯ç”±
â”‚   â”‚   â””â”€â”€ review.py           # å¤ç›˜è·¯ç”± âš ï¸ å·²å®ç°ä½†æœªæ³¨å†Œ
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â””â”€â”€ navbar.html     # å¯¼èˆªæ ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ index.html          # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ settings.html       # è®¾ç½®é¡µé¢
â”‚   â”‚   â”œâ”€â”€ bill_management.html # è´¦å•ç®¡ç†é¡µé¢
â”‚   â”‚   â”œâ”€â”€ history.html        # å¯¼å…¥å†å²é¡µé¢
â”‚   â”‚   â””â”€â”€ admin/              # ç®¡ç†å‘˜é¡µé¢
â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js         # è®¤è¯æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ navbar.js       # å¯¼èˆªæ é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ settings.js     # è®¾ç½®é¡µé¢é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ perf-utils.js   # æ€§èƒ½å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ datetime.js     # æ—¥æœŸæ—¶é—´å·¥å…·
â”‚   â”‚   â””â”€â”€ css/
â”‚   â”‚       â”œâ”€â”€ style.css       # ä¸»æ ·å¼
â”‚   â”‚       â”œâ”€â”€ settings.css    # è®¾ç½®é¡µé¢æ ·å¼
â”‚   â”‚       â””â”€â”€ variables.css   # CSSå˜é‡
â”‚   â””â”€â”€ uploads/                # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ models.py                   # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ review_service.py           # å¤ç›˜æœåŠ¡ âœ… å·²å®ç°
â”œâ”€â”€ config.py                   # é…ç½®ç®¡ç†
â””â”€â”€ .env.example                # ç¯å¢ƒå˜é‡ç¤ºä¾‹
```

---

## äºŒã€å…³é”®æ–‡ä»¶åˆ†æ

### 1. è´¦å•ç®¡ç†é¡µé¢ (bill_management.html)
**åŠŸèƒ½**: è´¦å•æ–‡ä»¶ä¸Šä¼ å’Œå¯¼å…¥ç®¡ç†
**ç‰¹ç‚¹**:
- æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ 
- æ–‡ä»¶åˆ—è¡¨è¡¨æ ¼ï¼ˆæ”¯æŒç­›é€‰ã€æ‰¹é‡æ“ä½œï¼‰
- å¯¼å…¥æˆåŠŸåæ˜¾ç¤ºç»“æœæ¶ˆæ¯
- å·²æœ‰ Banner æç¤ºæ¨¡å¼ï¼ˆNotion é…ç½®æç¤ºï¼‰

**é›†æˆç‚¹**: åœ¨å¯¼å…¥æˆåŠŸåæ·»åŠ å¤ç›˜æç¤º Banner

### 2. è®¾ç½®é¡µé¢ (settings.html)
**åŠŸèƒ½**: ç”¨æˆ·ä¸ªäººèµ„æ–™ã€å®‰å…¨è®¾ç½®ã€Notioné…ç½®
**ç‰¹ç‚¹**:
- ä¾§è¾¹æ å¯¼èˆª + å†…å®¹åŒºå¸ƒå±€
- Tabåˆ‡æ¢æ¨¡å¼
- è¡¨å•éªŒè¯
- é…ç½®éªŒè¯åŠŸèƒ½

**é›†æˆç‚¹**: æ·»åŠ å¤ç›˜é…ç½® section

### 3. å¯¼èˆªæ ç»„ä»¶ (navbar.html)
**åŠŸèƒ½**: é¡¶éƒ¨å¯¼èˆªæ 
**ç‰¹ç‚¹**:
- å“åº”å¼è®¾è®¡
- ç”¨æˆ·ä¸‹æ‹‰èœå•
- å¯¼èˆªé“¾æ¥åˆ—è¡¨

**é›†æˆç‚¹**: æ·»åŠ å¤ç›˜é¡µé¢å¯¼èˆªé“¾æ¥

---

## ä¸‰ã€è®¾è®¡æ¨¡å¼è¯†åˆ«

### 1. JavaScript æ¨¡å¼
```javascript
// IIFE æ¨¡å¼å°è£…
(function() {
    'use strict';

    // ç§æœ‰å˜é‡å’Œå‡½æ•°
    function showToast(message, type = 'success') { ... }

    // å…¬å¼€API
    window.MyModule = {
        init: function() { ... }
    };
})();

// é¡µé¢åˆå§‹åŒ–
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    setTimeout(init, 50);
}
```

### 2. API è°ƒç”¨æ¨¡å¼
```javascript
// ç»Ÿä¸€ä½¿ç”¨ Auth æ¨¡å—
const response = await window.Auth.apiRequest('/api/endpoint', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
});
```

### 3. æ¶ˆæ¯æç¤ºæ¨¡å¼
```javascript
function showToast(message, type = 'success') {
    const container = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.innerHTML = `...`;
    container.appendChild(toast);
    setTimeout(() => toast.remove(), 3000);
}
```

### 4. Banner æç¤ºæ¨¡å¼
```javascript
function showBanner(message, actions) {
    const banner = document.createElement('div');
    banner.className = 'banner';
    banner.innerHTML = `
        <div class="banner-content">
            <div class="banner-icon">ğŸ”—</div>
            <div class="banner-text">${message}</div>
            <div class="banner-actions">${actions}</div>
        </div>
    `;
}
```

### 5. æ¨¡æ€æ¡†æ¨¡å¼
```javascript
function showModal(content) {
    const modal = document.getElementById('modal');
    const modalBody = document.getElementById('modal-body');
    modalBody.innerHTML = content;
    modal.style.display = 'flex';
}
```

---

## å››ã€æ ·å¼ç»„ç»‡æ¨¡å¼

### 1. CSS å˜é‡ç³»ç»Ÿ (variables.css)
```css
:root {
    --primary-color: #667eea;
    --success-color: #10b981;
    --danger-color: #ef4444;
    --warning-color: #f59e0b;
    /* ... */
}
```

### 2. å“åº”å¼è®¾è®¡æ¨¡å¼
```css
/* æ¡Œé¢ä¼˜å…ˆ */
.container {
    max-width: 1200px;
    padding: 40px 20px;
}

/* ç§»åŠ¨ç«¯é€‚é… */
@media (max-width: 768px) {
    .container {
        padding: 20px 16px;
    }
}
```

### 3. ç»„ä»¶æ ·å¼æ¨¡å¼
```css
/* æŒ‰é’®ç»„ä»¶ */
.btn {
    padding: 10px 20px;
    border-radius: 8px;
    /* ... */
}

.btn-primary { /* ... */ }
.btn-secondary { /* ... */ }
.btn-danger { /* ... */ }
```

---

## äº”ã€æŠ€æœ¯å€ºåŠ¡æ¸…å•

### å¿…é¡»è§£å†³
| ID | é—®é¢˜ | å½±å“ | å»ºè®® |
|----|------|------|------|
| TD-1 | review router æœªåœ¨ main.py ä¸­æ³¨å†Œ | APIä¸å¯ç”¨ | ç«‹å³æ³¨å†Œå¹¶æµ‹è¯• |

### å»ºè®®ä¼˜åŒ–
| ID | é—®é¢˜ | å½±å“ | å»ºè®® |
|----|------|------|------|
| TD-2 | settings.html å†…è”æ ·å¼è¿‡å¤š | å¯ç»´æŠ¤æ€§ä½ | æå–åˆ° settings.css |
| TD-3 | bill_management.html å†…è”è„šæœ¬è¿‡é•¿ | å¯è¯»æ€§ä½ | æå–åˆ°ç‹¬ç«‹ JS æ–‡ä»¶ |

---

## å…­ã€é›†æˆå»ºè®®

### 1. è®¾ç½®é¡µé¢é›†æˆ
**ä½ç½®**: `settings.html`
**æ–¹å¼**: æ·»åŠ æ–°çš„ä¾§è¾¹æ å¯¼èˆªé¡¹å’Œå¯¹åº”çš„å†…å®¹section

```html
<!-- ä¾§è¾¹æ  -->
<a href="#review" class="sidebar-item" data-section="review">
    <span>ğŸ“Š</span>
    <span>å¤ç›˜é…ç½®</span>
</a>

<!-- å†…å®¹åŒº -->
<section class="settings-section" id="review-section" style="display: none;">
    <h2>å¤ç›˜é…ç½®</h2>
    <!-- é…ç½®è¡¨å• -->
</section>
```

### 2. è´¦å•ç®¡ç†é¡µé¢é›†æˆ
**ä½ç½®**: `bill_management.html`
**æ–¹å¼**: åœ¨å¯¼å…¥æˆåŠŸåæ˜¾ç¤ºå¤ç›˜æç¤º Banner

```javascript
// åœ¨ importFile å‡½æ•°çš„æˆåŠŸå›è°ƒä¸­
if (response.ok) {
    const data = await response.json();
    if (data.success) {
        showToast(`å¯¼å…¥æˆåŠŸï¼å…±å¯¼å…¥ ${data.imported || 0} æ¡è®°å½•`);
        showReviewBanner();  // æ˜¾ç¤ºå¤ç›˜æç¤º
    }
}
```

### 3. å¤ç›˜ç®¡ç†é¡µé¢
**ä½ç½®**: æ–°å»º `review.html`
**æ–¹å¼**: å‚è€ƒç°æœ‰é¡µé¢çš„å¸ƒå±€å’Œæ ·å¼æ¨¡å¼

### 4. å¯¼èˆªæ é›†æˆ
**ä½ç½®**: `navbar.html`
**æ–¹å¼**: åœ¨å¯¼èˆªåˆ—è¡¨ä¸­æ·»åŠ å¤ç›˜é“¾æ¥

```html
<a href="/review" class="nav-link">
    <span>ğŸ“Š</span>
    <span>å¤ç›˜ç®¡ç†</span>
</a>
```

---

## ä¸ƒã€å®æ–½ä¼˜å…ˆçº§

### P0 - å¿…é¡»å®Œæˆ
- [ ] åœ¨ main.py ä¸­æ³¨å†Œ review router
- [ ] åœ¨è®¾ç½®é¡µé¢æ·»åŠ å¤ç›˜é…ç½® section
- [ ] åœ¨è´¦å•å¯¼å…¥æˆåŠŸåæ˜¾ç¤ºå¤ç›˜æç¤º
- [ ] åˆ›å»ºå¤ç›˜ç®¡ç†é¡µé¢
- [ ] åœ¨å¯¼èˆªæ æ·»åŠ å¤ç›˜é“¾æ¥

### P1 - åº”è¯¥å®Œæˆ
- [ ] å®ç°å¤ç›˜é¢„è§ˆåŠŸèƒ½
- [ ] æ·»åŠ é…ç½®éªŒè¯åŠŸèƒ½
- [ ] å®ç°å“åº”å¼è®¾è®¡

### P2 - å¯ä»¥å»¶å
- [ ] å¤ç›˜å†å²è®°å½•æŸ¥è¯¢ï¼ˆéœ€åç«¯APIï¼‰
- [ ] æ‰¹é‡ç”Ÿæˆå¤ç›˜
- [ ] å¤ç›˜æ•°æ®å¯è§†åŒ–

---

## å…«ã€å¼€å‘å·¥ä½œä¼°ç®—

| ä»»åŠ¡ | é¢„ä¼°æ—¶é—´ | è¯´æ˜ |
|------|----------|------|
| æ³¨å†Œ review router | 0.5å°æ—¶ | ä¿®æ”¹ main.py |
| è®¾ç½®é¡µé¢é›†æˆ | 2å°æ—¶ | HTML + JS + CSS |
| è´¦å•ç®¡ç†é¡µé¢é›†æˆ | 1.5å°æ—¶ | æ·»åŠ  Banner |
| å¤ç›˜ç®¡ç†é¡µé¢ | 4å°æ—¶ | æ–°å»ºé¡µé¢ |
| å¯¼èˆªæ é›†æˆ | 0.5å°æ—¶ | æ·»åŠ é“¾æ¥ |
| æµ‹è¯•å’Œè°ƒè¯• | 1å°æ—¶ | åŠŸèƒ½æµ‹è¯• |
| **æ€»è®¡** | **9.5å°æ—¶** | çº¦1-2ä¸ªå·¥ä½œæ—¥ |

---

## ä¹ã€å‚è€ƒæ–‡æ¡£

### åç«¯APIæ–‡æ¡£
- **ç”Ÿæˆå¤ç›˜**: `POST /api/review/generate`
- **æ‰¹é‡ç”Ÿæˆ**: `POST /api/review/batch`
- **è·å–é…ç½®**: `GET /api/review/config`
- **æ›´æ–°é…ç½®**: `POST /api/review/config`
- **é¢„è§ˆæ•°æ®**: `GET /api/review/preview`

### ç›¸å…³æ–‡ä»¶
- `review_service.py` - å¤ç›˜æœåŠ¡å®ç°
- `web_service/routes/review.py` - API è·¯ç”±å®šä¹‰
- `models.py` - æ•°æ®æ¨¡å‹

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2026-02-03
